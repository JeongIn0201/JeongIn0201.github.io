(function(){"use strict";var t={8787:function(t,e,i){var l=i(5471),s=i(5668),a=i(4414),n=i(8779),o=i(8160),r=i(6506),c=i(8907),p=i(1554),d=i(2756),h=function(){var t=this,e=t._self._c;return e(s.A,[e(r.A,[e(n.A,{attrs:{fluid:""}},[e(o.A,{},[e(d.A,{attrs:{"no-gutters":""}},[e(a.A,{staticClass:"list-box-group",attrs:{cols:"3"}},[e("FileListBoxVue",{attrs:{fileList:t.allFileList,fileType:t.fileType},on:{addFiles:t.addFiles,clearFiles:t.clearFiles,removeFile:t.removeFile,changeType:t.changeType}}),e("EmployeeListBoxVue",{attrs:{allEmployeeList:t.allEmployeeList}})],1),e(a.A,{attrs:{cols:"9"}},[t.allFileList.length>0?e("DataReport",{attrs:{allFileList:t.allFileList,displayData:t.displayData,monthList:t.monthList,allEmployeeList:t.allEmployeeList,pointActivity:t.pointActivity,spotActivity:t.spotActivity}}):t._e()],1)],1),e("div",{staticClass:"loading"},[e(c.A,{model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[e(p.A,{attrs:{size:50,color:"primary",indeterminate:""}})],1)],1)],1)],1)],1)],1)},y=[],f=(i(4114),i(3316)),u=i(2938),m=i(9296),v=i(2367),g=function(){var t=this,e=t._self._c;return e(f.A,{staticClass:"list-box"},[e(m.A,{attrs:{dense:""}},[e(v.sw,[t._v("직원 목록")])],1),e(u.OQ,[e("ul",{staticClass:"all-employee-list"},[t._l(Object.keys(t.allEmployeeList),(function(i){return[e("li",{key:i,staticClass:"item"},[e("div",{staticClass:"employee-name"},[t._v(t._s(i))])])]}))],2)])],1)},_=[],A={name:"EmployeeListBox",props:["allEmployeeList"],data(){return{selected:[]}}},F=A,L=i(1656),b=(0,L.A)(F,g,_,!1,null,"43479be2",null),T=b.exports,x=i(3740),C=i(9483),k=i(6930),w=i(8983),D=i(7296),O=i(739),E=i(2090),S=i(2236),$=function(){var t=this,e=t._self._c;return e(f.A,{staticClass:"list-box"},[e(m.A,{staticClass:"fileupload-box",attrs:{dens:""}},[e(v.sw,[t._v("파일 목록")]),e("div",{staticClass:"d-flex",staticStyle:{width:"100%","justify-content":"space-between","align-items":"center"}},[e("div",[e(S.A,{staticClass:"file-type-radio",attrs:{"hide-details":""},on:{change:function(e){return t.$emit("changeType",t.radioType)}},model:{value:t.radioType,callback:function(e){t.radioType=e},expression:"radioType"}},[e(E.A,{attrs:{label:"지적활동",value:"pointActivity"}}),e(E.A,{attrs:{label:"스팟활동",value:"spotActivity"}})],1)],1),e("div",{staticClass:"actions"},[e(x.A,{staticClass:"white--text",attrs:{color:"btn_primary",dark:"","x-small":""},on:{click:function(e){t.openFileUploadDlg=!0}}},[t._v(" 업로드 ")]),e(x.A,{staticClass:"ml-2 white--text",attrs:{color:"btn_primary",dark:"","x-small":""},on:{click:function(e){return t.$emit("clearFiles")}}},[t._v(" 초기화 ")])],1)])],1),e(w.A,{staticClass:"file-list-wrap"},[e(O.A,{attrs:{"active-class":"pink--text"}},[t._l(t.fileList,(function(i,l){return[i.fileKey?e(D.A,{key:i.title},[e("div",{staticClass:"file-item"},[e("div",{staticClass:"file-name"},[t._v(" ("+t._s("pointActivity"==i.fileType?"지적활동":"스팟활동")+") "+t._s(i.fileName)+" ")]),e(x.A,{staticClass:"btn-file-remove",on:{click:function(e){return t.$emit("removeFile",i,l)}}},[e(k.A,{attrs:{dark:""}},[t._v(" mdi-minus ")])],1)],1),l<t.items.length-1?e(C.A,{key:l}):t._e()],1):t._e()]}))],2)],1),t.openFileUploadDlg?e("FileUploadDialogVue",{on:{close:t.closeDlg,addFiles:t.addFiles}}):t._e()],1)},j=[],K=i(6239),N=i(1034),B=function(){var t=this,e=t._self._c;return e(K.A,{attrs:{value:!0,"content-class":"file-upload-dlg"}},[e(f.A,[e(u.OQ,{staticClass:"pa-0"},[e("div",{staticClass:"dropzone-container",on:{dragover:t.dragover,dragleave:t.dragleave,drop:t.drop}},[e("input",{ref:"file",staticClass:"hidden-input",attrs:{type:"file",multiple:"",name:"file",id:"fileInput",accept:".pdf,.jpg,.jpeg,.png"},on:{change:t.onChange}}),e("label",{staticClass:"file-label",attrs:{for:"fileInput"}},[t.isDragging?e("div",[t._v("Release to drop files here.")]):e("div",[t._v("Drop files here or "),e("u",[t._v("click here")]),t._v(" to upload.")])])]),e("div",{staticClass:"uploaded-file-list"},[e("div",[t._v("업로드 파일: "+t._s(t.files.length)+" 건")]),e("ul",{staticClass:"file-list-wrap"},t._l(t.files,(function(i,l){return e("li",{key:`upload_file_${l}`,staticClass:"item"},[e("div",{staticClass:"file-name"},[t._v(t._s(i.name))]),e(x.A,{staticClass:"white--text",attrs:{color:"btn_primary","x-small":""}},[e(k.A,{attrs:{dark:""}},[t._v(" mdi-minus ")])],1)],1)})),0)])]),e(C.A),e(u.SL,[e(N.A),e(x.A,{on:{click:function(e){return t.$emit("close")}}},[t._v(" 닫기 ")]),e(x.A,{attrs:{color:"primary"},on:{click:t.addFiles}},[t._v(" 추가 ")])],1)],1)],1)},I=[],U={data(){return{isDragging:!1,files:[]}},methods:{addFiles(){this.$emit("addFiles",this.files)},onChange(){this.files.push(...this.$refs.file.files),console.log(this.files)},dragover(t){t.preventDefault(),this.isDragging=!0},dragleave(){this.isDragging=!1},drop(t){t.preventDefault(),this.$refs.file.files=t.dataTransfer.files,this.onChange(),this.isDragging=!1}}},M=U,P=(0,L.A)(M,B,I,!1,null,"6e484c9c",null),R=P.exports,V={name:"FileListBox",components:{FileUploadDialogVue:R},props:{fileList:{type:Array},fileType:{type:String}},data(){return{openFileUploadDlg:!1,selected:[],radioType:"",items:[{action:"15 min",headline:"Brunch this weekend?",subtitle:"I'll be in your neighborhood doing errands this weekend. Do you want to hang out?",title:"Ali Connors"},{action:"2 hr",headline:"Summer BBQ",subtitle:"Wish I could come, but I'm out of town this weekend.",title:"me, Scrott, Jennifer"},{action:"6 hr",headline:"Oui oui",subtitle:"Do you have Paris recommendations? Have you ever been?",title:"Sandra Adams"}]}},created(){this.radioType=this.fileType},methods:{addFiles(t){this.$emit("addFiles",t),this.closeDlg()},closeDlg(){this.openFileUploadDlg=!1}}},J=V,H=(0,L.A)(J,$,j,!1,null,null,null),Q=H.exports,z=i(2498),W=function(){var t=this,e=t._self._c;return e("section",{staticClass:"data-report-section"},[e(d.A,[e("div",{staticStyle:{padding:"10px"}},[t._v(" 전체 파일 "+t._s(t.allFileList.length)+"개 중 "+t._s(t.completeFileCnt())+"개 읽기 완료 ")])]),e(d.A,[e(z.A,[e("thead",[e("tr",[e("th",{staticStyle:{width:"170px"},attrs:{rowspan:"2"}},[t._v("이름")]),t._l(t.monthList,(function(i){return e("th",{key:i,attrs:{colspan:"3"}},[t._v(" "+t._s(i)+"월 ")])}))],2),e("tr",[t._l(t.monthList,(function(i){return[e("th",{key:`${i}_point`,staticStyle:{width:"80px"}},[t._v("지적활동")]),e("th",{key:`${i}_spot`,staticStyle:{width:"80px"}},[t._v("스팟활동")]),e("th",{key:`${i}_band`,staticStyle:{width:"80px"}},[t._v("밴드활동")])]}))],2)]),e("tbody",t._l(Object.keys(t.allEmployeeList),(function(i){return e("tr",{key:i},[e("td",{staticStyle:{width:"170px"}},[t._v(t._s(i))]),t._l(t.monthList,(function(l){return[e("td",{key:`${l}_value_point`},[t._v(" "+t._s(t.pointActivity&&t.pointActivity[l]&&t.pointActivity[l][i]?t.pointActivity[l][i]:0)+" ")]),e("td",{key:`${l}_value_spot`},[t._v(" "+t._s(t.spotActivity&&t.spotActivity[l]&&t.spotActivity[l][i]?t.spotActivity[l][i]:0)+" ")]),e("td",{key:`${l}_value_sum`},[t._v(t._s(t.sum(l,i)))])]}))],2)})),0)])],1)],1)},q=[],G={name:"DataReport",props:{displayData:{type:Object},monthList:{type:Array},allEmployeeList:{type:Object},pointActivity:{type:Object},spotActivity:{type:Object},allFileList:{tpye:Array}},data(){return{headers:[]}},watch:{displayData:{handler(){this.initHeaders()},deep:!0},allEmployeeList:{deep:!0,handler(){}}},created(){console.log(this.spotActivity)},methods:{sum(t,e){let i=0,l=0;this.pointActivity&&this.pointActivity[t]&&this.pointActivity[t][e]&&(i=1*this.pointActivity[t][e]),this.spotActivity&&this.spotActivity[t]&&this.spotActivity[t][e]&&(l=1*this.spotActivity[t][e]);const s=i+l;return s},completeFileCnt(){const t=this.allFileList.filter((t=>t.load));return t.length},parseName(t){let e=t;return e.includes('"')&&console.log(e),e=e.substr(0,3),e},initHeaders(){console.log("@@@@initHeaders@@@")}}},X=G,Y=(0,L.A)(X,W,q,!1,null,"794da9f8",null),Z=Y.exports,tt=i(3959),et={name:"viewMain",components:{FileListBoxVue:Q,EmployeeListBoxVue:T,DataReport:Z},data(){return{fileType:"pointActivity",folders:[{title:"a"},{title:"b"}],fileList:[],allFileList:[],loading:!1,fileDatas:{},allEmployeeList:{},loadingFileReader:!1,monthList:[],displayData:{},pointActivity:{},spotActivity:{},loadingFlag:!1}},watch:{loadingFlag:{deep:!0,handler(){const t=this.allFileList.filter((t=>t.load));console.log("loadingCnt = ",t),t.length==this.allFileList.length&&(this.loading=!1)}}},methods:{changeType(t){this.fileType=t},removeFile(t,e){this.fileDatas[t.fileKey]&&delete this.fileDatas[t.fileKey],this.allFileList.splice(e,1),this.fileDatas={},this.allEmployeeList={},this.monthList=JSON.parse(JSON.stringify({})),this.displayData=JSON.parse(JSON.stringify({})),this.addFiles(this.allFileList)},clearFiles(){this.allFileList=[],this.fileDatas={},this.allEmployeeList={}},addFiles(t){console.log("addFiles"),t.map((t=>{const e=t.name;let i=e.split("_");i=i[i.length-1],i=i.split(".");const l=i[0],s=this.$moment(l).format("MM");this[this.fileType][s]||(this[this.fileType]={...this[this.fileType],[s]:{}}),this[this.fileType][s][l]||(this[this.fileType]={...this[this.fileType],[s]:{...this[this.fileType][s],[l]:{}}}),this.monthList.includes(s)||(this.monthList.push(s),this.monthList.sort());const a={fileKey:l,fileType:this.fileType,fileName:e,monthKey:s},n=this.allFileList.findIndex((t=>t.fileKey===l&&t.fileType==this.fileType));-1==n?this.allFileList.push({fileKey:l,fileType:this.fileType,fileName:e,monthKey:s,load:!1}):this.allFileList[n]={fileKey:l,fileType:this.fileType,fileName:e,monthKey:s,load:!1},this.readFile(t,a),this.$forceUpdate()}))},readFile(t,e){const i=this;this.loading=!0;let l=new FileReader;l.onload=()=>{const t=l.result,s=tt.LF(t,{type:"binary"}),a=tt.Wp.sheet_to_json(s.Sheets[s.SheetNames[0]]);i.parseFileData(e,a).then((()=>{console.log("success"),console.log("fileInfo = ",e),console.log(i.allFileList);const t=i.allFileList.findIndex((t=>t.fileKey==e.fileKey&&t.fileType==e.fileType));t>-1&&(i.allFileList[t].load=!0,i.loadingFlag=!i.loadingFlag),this.$forceUpdate()})).catch((()=>{i.loading=!1}))},l.readAsBinaryString(t)},parseEmployeeName(t){if(!t)return"";let e=t;const i=["(","/"];return i.map((t=>{let i=e.indexOf(t);i>-1&&(e=e.substr(0,i))})),e=e.replaceAll('"',""),e},parseFileData(t,e){return new Promise((i=>{for(let l=0;l<100;l++){const s=e[l];s||i();const a=s["이름"];let n=this.parseEmployeeName(a);if(n){if(this.allEmployeeList[n]){const t=1*this.allEmployeeList[n].count;this.allEmployeeList={...this.allEmployeeList,[n]:{count:t+1}}}else this.allEmployeeList={...this.allEmployeeList,[n]:{count:1}};if(this[this.fileType][t.monthKey][n]){const e=1*this[this.fileType][t.monthKey][n];this[this.fileType][t.monthKey]={...this[this.fileType][t.monthKey],[n]:e+1}}else this[this.fileType][t.monthKey]={...this[this.fileType][t.monthKey],[n]:1}}}i()}))}}},it=et,lt=(0,L.A)(it,h,y,!1,null,null,null),st=lt.exports,at=i(5868);l.Ay.use(at.A);var nt=new at.A({theme:{light:!0,themes:{light:{primary:"#2270a3",btn_primary:"#2270a3"}}}}),ot=(i(4301),i(5624)),rt=i.n(ot);l.Ay.config.productionTip=!1,l.Ay.use(rt()),new l.Ay({vuetify:nt,render:t=>t(st)}).$mount("#app")}},e={};function i(l){var s=e[l];if(void 0!==s)return s.exports;var a=e[l]={exports:{}};return t[l].call(a.exports,a,a.exports,i),a.exports}i.m=t,function(){var t=[];i.O=function(e,l,s,a){if(!l){var n=1/0;for(p=0;p<t.length;p++){l=t[p][0],s=t[p][1],a=t[p][2];for(var o=!0,r=0;r<l.length;r++)(!1&a||n>=a)&&Object.keys(i.O).every((function(t){return i.O[t](l[r])}))?l.splice(r--,1):(o=!1,a<n&&(n=a));if(o){t.splice(p--,1);var c=s();void 0!==c&&(e=c)}}return e}a=a||0;for(var p=t.length;p>0&&t[p-1][2]>a;p--)t[p]=t[p-1];t[p]=[l,s,a]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var l in e)i.o(e,l)&&!i.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:e[l]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};i.O.j=function(e){return 0===t[e]};var e=function(e,l){var s,a,n=l[0],o=l[1],r=l[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(r)var p=r(i)}for(e&&e(l);c<n.length;c++)a=n[c],i.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return i.O(p)},l=self["webpackChunkdata_extract"]=self["webpackChunkdata_extract"]||[];l.forEach(e.bind(null,0)),l.push=e.bind(null,l.push.bind(l))}();var l=i.O(void 0,[504],(function(){return i(8787)}));l=i.O(l)})();
//# sourceMappingURL=app.8263c29a.js.map